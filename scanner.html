<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System QR Scanner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0c0c2e 0%, #1a1a4a 100%);
            color: white;
            min-height: 100vh;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
        }

        /* HEADER */
        .header {
            text-align: center;
            padding: 20px 0;
        }

        .logo {
            font-size: 48px;
            margin-bottom: 10px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .title {
            font-size: 22px;
            font-weight: 600;
            background: linear-gradient(45deg, #4fc3f7, #2979ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .subtitle {
            font-size: 14px;
            color: #b3e5fc;
            opacity: 0.9;
        }

        /* SCANNER SECTION */
        .scanner-section {
            margin: 20px 0;
        }

        .scanner-frame {
            width: 100%;
            height: 300px;
            border-radius: 20px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(79, 195, 247, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        #qr-reader {
            width: 100%;
            height: 100%;
        }

        .scanner-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .scanning-line {
            width: 80%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #4fc3f7, transparent);
            animation: scan 2s ease-in-out infinite;
            box-shadow: 0 0 10px #4fc3f7;
        }

        @keyframes scan {
            0%, 100% { transform: translateY(-60px); }
            50% { transform: translateY(60px); }
        }

        .scanning-text {
            position: absolute;
            bottom: 15px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 14px;
            color: #4fc3f7;
            font-weight: 500;
        }

        /* CAMERA PERMISSION */
        .permission-box {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
        }

        .permission-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .permission-text {
            font-size: 16px;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .permission-btn {
            background: linear-gradient(135deg, #4fc3f7, #2979ff);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
        }

        /* NOW PLAYING */
        .now-playing {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            display: none;
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .now-playing-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .playing-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #4fc3f7;
            font-weight: 600;
        }

        .playing-dot {
            width: 8px;
            height: 8px;
            background: #4fc3f7;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .planet-display {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .planet-icon-container {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .planet-icon {
            font-size: 36px;
        }

        .planet-info {
            flex: 1;
        }

        .planet-name {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 5px;
            background: linear-gradient(45deg, #ffffff, #b3e5fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .planet-description {
            font-size: 13px;
            color: #b3e5fc;
            opacity: 0.9;
        }

        /* AUDIO WAVE */
        .audio-wave {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            height: 50px;
            gap: 4px;
            margin: 20px 0;
        }

        .wave-bar {
            width: 4px;
            min-height: 5px;
            background: linear-gradient(to top, #4fc3f7, #2979ff);
            border-radius: 2px;
            animation: wave 1.5s infinite ease-in-out;
        }

        @keyframes wave {
            0%, 100% { height: 5px; }
            25% { height: 20px; }
            50% { height: 35px; }
            75% { height: 15px; }
        }

        /* CONTROLS */
        .audio-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-btn:active {
            background: rgba(79, 195, 247, 0.2);
        }

        .control-btn-main {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #4fc3f7, #2979ff);
            font-size: 20px;
        }

        /* MANUAL INPUT */
        .manual-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .manual-title {
            font-size: 16px;
            margin-bottom: 15px;
            color: #4fc3f7;
            text-align: center;
        }

        .planet-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .planet-btn {
            padding: 15px 5px;
            border-radius: 10px;
            border: none;
            color: white;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .planet-btn:active {
            transform: scale(0.95);
        }

        .planet-btn-icon {
            font-size: 24px;
        }

        /* STATUS */
        .status {
            text-align: center;
            padding: 12px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 14px;
            display: none;
        }

        .status-scanning {
            background: rgba(79, 195, 247, 0.1);
            color: #4fc3f7;
            border: 1px solid rgba(79, 195, 247, 0.2);
        }

        .status-success {
            background: rgba(76, 175, 80, 0.1);
            color: #4caf50;
            border: 1px solid rgba(76, 175, 80, 0.2);
        }

        .status-error {
            background: rgba(244, 67, 54, 0.1);
            color: #f44336;
            border: 1px solid rgba(244, 67, 54, 0.2);
        }

        /* RESPONSIVE */
        @media (max-width: 480px) {
            .container { padding: 15px; }
            .scanner-frame { height: 280px; }
            .planet-grid { grid-template-columns: repeat(2, 1fr); }
            .planet-icon-container { width: 60px; height: 60px; }
            .planet-icon { font-size: 30px; }
        }
    </style>
    <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <div class="logo">üåå</div>
            <div class="title">Solar System QR Scanner</div>
            <div class="subtitle">Point camera at expired QR codes</div>
        </div>

        <!-- SCANNER -->
        <div class="scanner-section">
            <div class="scanner-frame">
                <div id="qr-reader"></div>
                <div class="scanner-overlay">
                    <div class="scanning-line"></div>
                    <div class="scanning-text">üîç Align QR code within frame</div>
                </div>
            </div>
        </div>

        <!-- CAMERA PERMISSION -->
        <div id="permissionBox" class="permission-box">
            <div class="permission-icon">üì±</div>
            <div class="permission-text">
                Camera access is required to scan QR codes.<br>
                Please allow camera permissions.
            </div>
            <button class="permission-btn" onclick="requestCamera()">Allow Camera</button>
        </div>

        <!-- STATUS -->
        <div id="statusMessage" class="status"></div>

        <!-- NOW PLAYING -->
        <div id="nowPlaying" class="now-playing">
            <div class="now-playing-header">
                <div class="playing-label">Now Playing</div>
                <div class="playing-dot"></div>
            </div>

            <div class="planet-display">
                <div class="planet-icon-container" id="planetIconContainer">
                    <div class="planet-icon" id="planetIcon">üåå</div>
                </div>
                <div class="planet-info">
                    <div class="planet-name" id="planetName">Solar System</div>
                    <div class="planet-description" id="planetDescription">Audio Guide</div>
                </div>
            </div>

            <div class="audio-wave" id="audioWave"></div>

            <div class="audio-controls">
                <button class="control-btn" onclick="skipBackward()">‚è™</button>
                <button class="control-btn control-btn-main" onclick="togglePlayPause()" id="playPauseBtn">
                    ‚è∏Ô∏è
                </button>
                <button class="control-btn" onclick="skipForward()">‚è©</button>
            </div>
        </div>

        <!-- MANUAL FALLBACK -->
        <div class="manual-section">
            <div class="manual-title">Or Select Planet Manually:</div>
            <div class="planet-grid">
                <button class="planet-btn" style="background: linear-gradient(135deg, #ff9800, #ff5722);" onclick="playPlanet('sun')">
                    <span class="planet-btn-icon">‚òÄÔ∏è</span>
                    <span>SUN</span>
                </button>
                <button class="planet-btn" style="background: linear-gradient(135deg, #9e9e9e, #616161);" onclick="playPlanet('mercury')">
                    <span class="planet-btn-icon">ü™ê</span>
                    <span>MERCURY</span>
                </button>
                <button class="planet-btn" style="background: linear-gradient(135deg, #ffcc80, #ff8a65);" onclick="playPlanet('venus')">
                    <span class="planet-btn-icon">üåü</span>
                    <span>VENUS</span>
                </button>
                <button class="planet-btn" style="background: linear-gradient(135deg, #4fc3f7, #2979ff);" onclick="playPlanet('earth')">
                    <span class="planet-btn-icon">üåç</span>
                    <span>EARTH</span>
                </button>
                <button class="planet-btn" style="background: linear-gradient(135deg, #ff5722, #d84315);" onclick="playPlanet('mars')">
                    <span class="planet-btn-icon">üî¥</span>
                    <span>MARS</span>
                </button>
                <button class="planet-btn" style="background: linear-gradient(135deg, #ffa726, #ff9800);" onclick="playPlanet('jupiter')">
                    <span class="planet-btn-icon">ü™ê</span>
                    <span>JUPITER</span>
                </button>
                <button class="planet-btn" style="background: linear-gradient(135deg, #ffca28, #ffb300);" onclick="playPlanet('saturn')">
                    <span class="planet-btn-icon">ü™ê</span>
                    <span>SATURN</span>
                </button>
                <button class="planet-btn" style="background: linear-gradient(135deg, #80deea, #4dd0e1);" onclick="playPlanet('uranus')">
                    <span class="planet-btn-icon">üîµ</span>
                    <span>URANUS</span>
                </button>
                <button class="planet-btn" style="background: linear-gradient(135deg, #5c6bc0, #3949ab);" onclick="playPlanet('neptune')">
                    <span class="planet-btn-icon">üîµ</span>
                    <span>NEPTUNE</span>
                </button>
            </div>
        </div>
    </div>

    <!-- HIDDEN AUDIO PLAYER -->
    <audio id="audioPlayer" preload="auto"></audio>

    <script>
        // üåç PLANET DATABASE
        const PLANETS = {
            sun: {
                name: 'THE SUN',
                description: 'Center of Our Solar System',
                color: '#ff9800',
                icon: '‚òÄÔ∏è',
                mp3: 'https://ttobitobi023-a11y.github.io/solar/Sun_9.mp3'
            },
            mercury: {
                name: 'MERCURY',
                description: 'Closest Planet to the Sun',
                color: '#9e9e9e',
                icon: 'ü™ê',
                mp3: 'https://ttobitobi023-a11y.github.io/solar/Mercury_2.mp3'
            },
            venus: {
                name: 'VENUS',
                description: 'Earth\'s Twin Sister',
                color: '#ffcc80',
                icon: 'üåü',
                mp3: 'https://ttobitobi023-a11y.github.io/solar/Venus_1.mp3'
            },
            earth: {
                name: 'EARTH',
                description: 'Our Home Planet',
                color: '#4fc3f7',
                icon: 'üåç',
                mp3: 'https://ttobitobi023-a11y.github.io/solar/Earth_3.mp3'
            },
            mars: {
                name: 'MARS',
                description: 'The Red Planet',
                color: '#ff5722',
                icon: 'üî¥',
                mp3: 'https://ttobitobi023-a11y.github.io/solar/Mars_4.mp3'
            },
            jupiter: {
                name: 'JUPITER',
                description: 'The Giant Planet',
                color: '#ffa726',
                icon: 'ü™ê',
                mp3: 'https://ttobitobi023-a11y.github.io/solar/Jupiter_5.mp3'
            },
            saturn: {
                name: 'SATURN',
                description: 'The Ringed Planet',
                color: '#ffca28',
                icon: 'ü™ê',
                mp3: 'https://ttobitobi023-a11y.github.io/solar/Saturn_6.mp3'
            },
            uranus: {
                name: 'URANUS',
                description: 'The Ice Giant',
                color: '#80deea',
                icon: 'üîµ',
                mp3: 'https://ttobitobi023-a11y.github.io/solar/Uranus_7.mp3'
            },
            neptune: {
                name: 'NEPTUNE',
                description: 'The Blue Giant',
                color: '#5c6bc0',
                icon: 'üîµ',
                mp3: 'https://ttobitobi023-a11y.github.io/solar/Neptune_8.mp3'
            }
        };

        // üîó QR PATTERNS - WILL DETECT YOUR MP3 LINKS
        const QR_PATTERNS = {
            // FULL MP3 LINKS
            'https://ttobitobi023-a11y.github.io/solar/Sun_9.mp3': 'sun',
            'https://ttobitobi023-a11y.github.io/solar/Mercury_2.mp3': 'mercury',
            'https://ttobitobi023-a11y.github.io/solar/Venus_1.mp3': 'venus',
            'https://ttobitobi023-a11y.github.io/solar/Earth_3.mp3': 'earth',
            'https://ttobitobi023-a11y.github.io/solar/Mars_4.mp3': 'mars',
            'https://ttobitobi023-a11y.github.io/solar/Jupiter_5.mp3': 'jupiter',
            'https://ttobitobi023-a11y.github.io/solar/Saturn_6.mp3': 'saturn',
            'https://ttobitobi023-a11y.github.io/solar/Uranus_7.mp3': 'uranus',
            'https://ttobitobi023-a11y.github.io/solar/Neptune_8.mp3': 'neptune',
            
            // MP3 FILENAMES
            'Sun_9.mp3': 'sun',
            'Mercury_2.mp3': 'mercury',
            'Venus_1.mp3': 'venus',
            'Earth_3.mp3': 'earth',
            'Mars_4.mp3': 'mars',
            'Jupiter_5.mp3': 'jupiter',
            'Saturn_6.mp3': 'saturn',
            'Uranus_7.mp3': 'uranus',
            'Neptune_8.mp3': 'neptune'
        };

        // üéµ AUDIO SYSTEM
        const audioPlayer = document.getElementById('audioPlayer');
        let currentPlanet = null;
        let isPlaying = false;
        let qrScanner = null;

        // Initialize audio wave
        function initAudioWave() {
            const waveContainer = document.getElementById('audioWave');
            waveContainer.innerHTML = '';
            for (let i = 0; i < 12; i++) {
                const bar = document.createElement('div');
                bar.className = 'wave-bar';
                bar.style.animationDelay = `${i * 0.1}s`;
                waveContainer.appendChild(bar);
            }
        }

        // Show status
        function showStatus(message, type = 'scanning') {
            const statusEl = document.getElementById('statusMessage');
            statusEl.textContent = message;
            statusEl.className = `status status-${type}`;
            statusEl.style.display = 'block';
            
            if (type !== 'error') {
                setTimeout(() => {
                    statusEl.style.display = 'none';
                }, 3000);
            }
        }

        // Detect planet from QR data
        function detectPlanetFromQR(qrData) {
            const lowerData = qrData.toLowerCase();
            
            // Check patterns
            for (const [pattern, planet] of Object.entries(QR_PATTERNS)) {
                if (lowerData.includes(pattern.toLowerCase())) {
                    return planet;
                }
            }
            
            return null;
        }

        // Play planet audio
        function playPlanet(planetKey) {
            const planet = PLANETS[planetKey];
            if (!planet) return;
            
            currentPlanet = planetKey;
            
            // Update UI
            document.getElementById('planetName').textContent = planet.name;
            document.getElementById('planetDescription').textContent = planet.description;
            document.getElementById('planetIcon').textContent = planet.icon;
            document.getElementById('planetIconContainer').style.background = 
                `linear-gradient(135deg, ${planet.color}, ${darkenColor(planet.color, 30)})`;
            
            // Show now playing
            document.getElementById('nowPlaying').style.display = 'block';
            
            // Set and play audio
            audioPlayer.src = planet.mp3;
            audioPlayer.volume = 0.7;
            
            audioPlayer.play().then(() => {
                isPlaying = true;
                document.getElementById('playPauseBtn').innerHTML = '‚è∏Ô∏è';
                startWaveAnimation();
                showStatus(`Playing ${planet.name}`, 'success');
            }).catch(error => {
                console.log("Auto-play blocked:", error);
                document.getElementById('playPauseBtn').innerHTML = '‚ñ∂Ô∏è';
                showStatus("Tap play button to start", 'error');
            });
        }

        // QR Scanner success handler
        function onScanSuccess(decodedText) {
            console.log("QR Detected:", decodedText);
            
            // Detect planet
            const planetKey = detectPlanetFromQR(decodedText);
            
            if (planetKey) {
                showStatus(`Detected: ${PLANETS[planetKey].name}`, 'success');
                
                // Stop scanner temporarily
                if (qrScanner) {
                    qrScanner.stop();
                }
                
                // Play audio
                setTimeout(() => {
                    playPlanet(planetKey);
                }, 500);
                
                // Restart scanner after delay
                setTimeout(() => {
                    startScanner();
                }, 5000);
                
            } else {
                showStatus("Unknown QR code. Try again.", 'error');
                
                // Restart scanner
                setTimeout(() => {
                    startScanner();
                }, 2000);
            }
        }

        // Start QR scanner
        function startScanner() {
            const config = {
                fps: 10,
                qrbox: 250
            };
            
            qrScanner = new Html5Qrcode("qr-reader");
            
            qrScanner.start(
                { facingMode: "environment" },
                config,
                onScanSuccess
            ).then(() => {
                showStatus("Ready to scan QR codes", 'scanning');
                document.getElementById('permissionBox').style.display = 'none';
            }).catch(err => {
                console.error("Scanner error:", err);
                document.getElementById('permissionBox').style.display = 'block';
                showStatus("Camera access needed", 'error');
            });
        }

        // Request camera permission
        function requestCamera() {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(() => {
                    startScanner();
                })
                .catch(err => {
                    showStatus("Cannot access camera. Use manual buttons.", 'error');
                });
        }

        // Audio controls
        function togglePlayPause() {
            if (audioPlayer.paused) {
                audioPlayer.play().then(() => {
                    isPlaying = true;
                    document.getElementById('playPauseBtn').innerHTML = '‚è∏Ô∏è';
                    startWaveAnimation();
                });
            } else {
                audioPlayer.pause();
                isPlaying = false;
                document.getElementById('playPauseBtn').innerHTML = '‚ñ∂Ô∏è';
                stopWaveAnimation();
            }
        }

        function skipBackward() {
            audioPlayer.currentTime = Math.max(0, audioPlayer.currentTime - 10);
        }

        function skipForward() {
            audioPlayer.currentTime = Math.min(audioPlayer.duration, audioPlayer.currentTime + 10);
        }

        function startWaveAnimation() {
            const bars = document.querySelectorAll('.wave-bar');
            bars.forEach(bar => {
                bar.style.animationPlayState = 'running';
            });
        }

        function stopWaveAnimation() {
            const bars = document.querySelectorAll('.wave-bar');
            bars.forEach(bar => {
                bar.style.animationPlayState = 'paused';
            });
        }

        function darkenColor(color, percent) {
            const num = parseInt(color.replace("#", ""), 16);
            const amt = Math.round(2.55 * percent);
            const R = Math.max((num >> 16) - amt, 0);
            const G = Math.max((num >> 8 & 0x00FF) - amt, 0);
            const B = Math.max((num & 0x0000FF) - amt, 0);
            return "#" + ((R << 16) + (G << 8) + B).toString(16).padStart(6, '0');
        }

        // Initialize
        function init() {
            initAudioWave();
            
            // Start scanner automatically
            startScanner();
            
            // Audio event listeners
            audioPlayer.addEventListener('ended', () => {
                isPlaying = false;
                document.getElementById('playPauseBtn').innerHTML = '‚ñ∂Ô∏è';
                stopWaveAnimation();
                
                // Restart scanner when audio ends
                setTimeout(() => {
                    startScanner();
                    showStatus("Ready for next QR scan", 'scanning');
                }, 1000);
            });
            
            audioPlayer.addEventListener('play', () => {
                isPlaying = true;
                document.getElementById('playPauseBtn').innerHTML = '‚è∏Ô∏è';
                startWaveAnimation();
            });
            
            audioPlayer.addEventListener('pause', () => {
                isPlaying = false;
                document.getElementById('playPauseBtn').innerHTML = '‚ñ∂Ô∏è';
                stopWaveAnimation();
            });
        }

        // Start when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>
